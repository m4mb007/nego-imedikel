<div class="min-h-screen bg-gray-50 py-8">
  <div class="max-w-2xl mx-auto px-4 sm:px-6 lg:px-8">
    <!-- Header -->
    <div class="mb-8">
      <div class="flex items-center mb-4">
        <%= link_to product_path(@product), class: "text-green-600 hover:text-green-700 mr-4" do %>
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path>
          </svg>
        <% end %>
        <h1 class="text-2xl font-bold text-gray-900">Write a Review</h1>
      </div>
      <p class="text-gray-600">Share your experience with <%= @product.name %></p>
    </div>

    <!-- Product Info -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-8">
      <div class="flex items-center">
        <div class="flex-shrink-0 h-16 w-16">
          <% if @product.main_image.attached? %>
            <%= image_tag @product.main_image, class: "h-16 w-16 rounded-lg object-cover" %>
          <% else %>
            <div class="h-16 w-16 rounded-lg bg-gray-200 flex items-center justify-center">
              <svg class="h-8 w-8 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
              </svg>
            </div>
          <% end %>
        </div>
        <div class="ml-4">
          <h2 class="text-lg font-medium text-gray-900"><%= @product.name %></h2>
          <p class="text-sm text-gray-500"><%= @product.category&.name %></p>
        </div>
      </div>
    </div>

    <!-- Review Form -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-6">
      <%= form_with(model: [@product, @review], local: true, class: "space-y-6") do |f| %>
        <%= render 'shared/error_messages', resource: @review %>

        <!-- Rating -->
        <div>
          <%= f.label :rating, class: "block text-sm font-medium text-gray-700 mb-2" %>
          <div class="flex items-center space-x-2">
            <% 5.times do |i| %>
              <%= f.radio_button :rating, i + 1, class: "sr-only", id: "rating_#{i + 1}" %>
              <label for="rating_<%= i + 1 %>" class="cursor-pointer">
                <svg class="w-8 h-8 text-gray-300 hover:text-yellow-400 transition-colors duration-200" fill="currentColor" viewBox="0 0 20 20">
                  <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                </svg>
              </label>
            <% end %>
          </div>
          <p class="text-sm text-gray-500 mt-1">Click on a star to rate this product</p>
        </div>

        <!-- Comment -->
        <div>
          <%= f.label :comment, "Your Review", class: "block text-sm font-medium text-gray-700 mb-2" %>
          <%= f.text_area :comment, 
              rows: 6,
              class: "block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500",
              placeholder: "Share your experience with this product. What did you like? What could be improved?" %>
          <p class="text-sm text-gray-500 mt-1">Be honest and helpful to other customers</p>
        </div>

        <!-- Submit Button -->
        <div class="flex justify-end space-x-4">
          <%= link_to "Cancel", product_path(@product), 
              class: "px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50" %>
          <%= f.submit "Submit Review", 
              class: "px-6 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 cursor-pointer" %>
        </div>
      <% end %>
    </div>
  </div>
</div>

<script>
  // Star rating interaction
  document.addEventListener('DOMContentLoaded', function() {
    const ratingInputs = document.querySelectorAll('input[name="review[rating]"]');
    const starLabels = document.querySelectorAll('label[for^="rating_"]');
    
    ratingInputs.forEach((input, index) => {
      input.addEventListener('change', function() {
        // Reset all stars
        starLabels.forEach((label, i) => {
          const svg = label.querySelector('svg');
          if (i <= index) {
            svg.classList.remove('text-gray-300');
            svg.classList.add('text-yellow-400');
          } else {
            svg.classList.remove('text-yellow-400');
            svg.classList.add('text-gray-300');
          }
        });
      });
    });
  });
</script>
